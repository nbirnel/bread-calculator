#!/usr/bin/env ruby

require 'bread_calculator'

@format = 'r'

loop { case ARGV[0]
  when /-summary/  then             @format = 'r.summary'; ARGV.shift; break
  when /-weight/   then             @format = 'r.weight';  ARGV.shift; break
  when /-scale-by/ then ARGV.shift; @format = "r.scale_by #{ARGV.shift}"; break
  when /--/ then ARGV.shift; break
  when /^-/ then usage("Unknown option: #{ARGV[0].inspect}")
  else break
end; }

ARGV.each do |arg|
  parser = BreadCalculator::Parser.new arg
  r = parser.parse(arg)
  puts eval("#{@format}")
end
